## 版本6

在版本3的基础上，使用线程代替进程编写服务器程序。

### 程序错误

1、连接时提示undefined reference to pthread_create 

因为pthread库不是标准的linux函数库，所以连接出错，在makefile中设置gcc编译选项，-lpthread

2、创建进程时，直接传递了描述符的地址，由于可能在线程复制其数值前，主程序就已经对其进行了修改，这样程序就出错了。

可以考虑直接传递数值。

3、对于2中的问题可以使用malloc和free来处理，但是二者又是不可重入的，因为他们内部使用了同一个结构。这就引出了线程化程序的线程安全问题以及对应的同步问题。


### 线程同步问题

1、可重入函数,多线程多次调用产生的结果相同.可重入函数一定是线程安全的函数,反之不成立.

不可重入函数的特点:

1)调用了malloc/free;2)调用了标准I/O库函数;3)使用了全局或静态的结构

2、线程安全都是由全局变量和静态变量引起的

3、线程化程序的不同线程之间，使用了相同的全局变量或静态变量。
